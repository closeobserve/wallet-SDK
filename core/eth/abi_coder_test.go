package eth

import (
	"encoding/hex"
	"math/big"
	"testing"

	"github.com/ethereum/go-ethereum/common"
	"github.com/stretchr/testify/require"
)

func TestAbiCoder(t *testing.T) {
	tick := "BEVM"
	to := "0xa2cCF83EA437565a37E1F2d49940e0C4C7D7591e"
	amount := big.NewInt(1000)

	data, err := AbiCoderEncode(
		[]string{"address", "address", "string", "string", "string", "uint256", "uint256", "uint256", "uint256", "uint16", "string"},
		common.HexToAddress("0x0"),
		common.HexToAddress(to),
		"src-20",
		"transfer",
		tick,
		big.NewInt(0),
		big.NewInt(0),
		big.NewInt(0),
		amount,
		uint16(0),
		"{}",
	)
	require.Nil(t, err)
	wantHex := "0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a2ccf83ea437565a37e1f2d49940e0c4c7d7591e000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000067372632d3230000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000087472616e7366657200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044245564d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000027b7d000000000000000000000000000000000000000000000000000000000000"
	require.Equal(t, "0x"+hex.EncodeToString(data), wantHex)
}
